INFO:root:Args in experiment:
INFO:root:Namespace(is_training=True, device=0, num_workers=0, data='custom', root_path='.', data_path='out_electricity_9.csv', features='M', target='OT', freq='h', seq_len=96, label_len=96, pred_len=96, embed='timeF', heads=16, d_model=100, N=10, block_nums=2, bottleneck=2, map_bottleneck=20, train_epochs=100, batch_size=32, patience=3, learning_rate=0.0005, tau=0.07, loss_weight_prediction=1.0, loss_weight_infonce=1.0, loss_weight_smooth=1.0, check_point='checkpoint')
INFO:root:Basisformer(
  (coefnet): Coefnet(
    (layers): ModuleList(
      (0): BCAB(
        (cross_attention_basis): channel_AutoCorrelationLayer(
          (query_projection): Linear(in_features=100, out_features=96, bias=True)
          (key_projection): Linear(in_features=100, out_features=96, bias=True)
          (value_projection): Linear(in_features=100, out_features=96, bias=True)
          (out_projection): Linear(in_features=96, out_features=100, bias=True)
          (attend): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (conv1_basis): Linear(in_features=100, out_features=400, bias=True)
        (conv2_basis): Linear(in_features=400, out_features=100, bias=True)
        (dropout_basis): Dropout(p=0.1, inplace=False)
        (cross_attention_ts): channel_AutoCorrelationLayer(
          (query_projection): Linear(in_features=100, out_features=96, bias=True)
          (key_projection): Linear(in_features=100, out_features=96, bias=True)
          (value_projection): Linear(in_features=100, out_features=96, bias=True)
          (out_projection): Linear(in_features=96, out_features=100, bias=True)
          (attend): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (conv1_ts): Linear(in_features=100, out_features=400, bias=True)
        (conv2_ts): Linear(in_features=400, out_features=100, bias=True)
        (dropout_ts): Dropout(p=0.1, inplace=False)
        (layer_norm11): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
        (layer_norm12): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
        (layer_norm21): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
        (layer_norm22): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
      )
      (1): BCAB(
        (cross_attention_basis): channel_AutoCorrelationLayer(
          (query_projection): Linear(in_features=100, out_features=96, bias=True)
          (key_projection): Linear(in_features=100, out_features=96, bias=True)
          (value_projection): Linear(in_features=100, out_features=96, bias=True)
          (out_projection): Linear(in_features=96, out_features=100, bias=True)
          (attend): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (conv1_basis): Linear(in_features=100, out_features=400, bias=True)
        (conv2_basis): Linear(in_features=400, out_features=100, bias=True)
        (dropout_basis): Dropout(p=0.1, inplace=False)
        (cross_attention_ts): channel_AutoCorrelationLayer(
          (query_projection): Linear(in_features=100, out_features=96, bias=True)
          (key_projection): Linear(in_features=100, out_features=96, bias=True)
          (value_projection): Linear(in_features=100, out_features=96, bias=True)
          (out_projection): Linear(in_features=96, out_features=100, bias=True)
          (attend): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (conv1_ts): Linear(in_features=100, out_features=400, bias=True)
        (conv2_ts): Linear(in_features=400, out_features=100, bias=True)
        (dropout_ts): Dropout(p=0.1, inplace=False)
        (layer_norm11): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
        (layer_norm12): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
        (layer_norm21): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
        (layer_norm22): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
      )
    )
    (last_layer): last_layer(
      (query_projection): Linear(in_features=100, out_features=96, bias=True)
      (key_projection): Linear(in_features=100, out_features=96, bias=True)
    )
  )
  (MLP_x): MLP_bottle(
    (linear1): Sequential(
      (0): Linear(in_features=96, out_features=48, bias=True)
      (1): ReLU()
      (2): Linear(in_features=48, out_features=48, bias=True)
    )
    (linear2): Sequential(
      (0): Linear(in_features=48, out_features=48, bias=True)
      (1): ReLU()
      (2): Linear(in_features=48, out_features=96, bias=True)
    )
    (skip): Linear(in_features=96, out_features=48, bias=True)
    (act): ReLU()
  )
  (MLP_y): MLP_bottle(
    (linear1): Sequential(
      (0): Linear(in_features=96, out_features=48, bias=True)
      (1): ReLU()
      (2): Linear(in_features=48, out_features=48, bias=True)
    )
    (linear2): Sequential(
      (0): Linear(in_features=48, out_features=48, bias=True)
      (1): ReLU()
      (2): Linear(in_features=48, out_features=96, bias=True)
    )
    (skip): Linear(in_features=96, out_features=48, bias=True)
    (act): ReLU()
  )
  (MLP_sx): MLP_bottle(
    (linear1): Sequential(
      (0): Linear(in_features=96, out_features=48, bias=True)
      (1): ReLU()
      (2): Linear(in_features=48, out_features=48, bias=True)
    )
    (linear2): Sequential(
      (0): Linear(in_features=48, out_features=48, bias=True)
      (1): ReLU()
      (2): Linear(in_features=48, out_features=96, bias=True)
    )
    (skip): Linear(in_features=96, out_features=48, bias=True)
    (act): ReLU()
  )
  (MLP_sy): MLP_bottle(
    (linear1): Sequential(
      (0): Linear(in_features=96, out_features=48, bias=True)
      (1): ReLU()
      (2): Linear(in_features=48, out_features=48, bias=True)
    )
    (linear2): Sequential(
      (0): Linear(in_features=48, out_features=48, bias=True)
      (1): ReLU()
      (2): Linear(in_features=48, out_features=96, bias=True)
    )
    (skip): Linear(in_features=96, out_features=48, bias=True)
    (act): ReLU()
  )
  (project1): Linear(in_features=96, out_features=100, bias=True)
  (project2): Linear(in_features=96, out_features=100, bias=True)
  (project3): Linear(in_features=96, out_features=100, bias=True)
  (project4): Linear(in_features=96, out_features=100, bias=True)
  (criterion1): MSELoss()
  (criterion2): L1Loss()
  (map_MLP): MLP_bottle(
    (linear1): Sequential(
      (0): Linear(in_features=1, out_features=20, bias=True)
      (1): ReLU()
      (2): Linear(in_features=20, out_features=20, bias=True)
    )
    (linear2): Sequential(
      (0): Linear(in_features=20, out_features=20, bias=True)
      (1): ReLU()
      (2): Linear(in_features=20, out_features=1920, bias=True)
    )
    (skip): Linear(in_features=1, out_features=20, bias=True)
    (act): ReLU()
  )
)
INFO:root:[Info] Number of parameters: 660360
INFO:root:	iters: 3, epoch: 1 | loss: 11310024.0000000
INFO:root:	iters: 6, epoch: 1 | loss: 11560197.0000000
INFO:root:	iters: 9, epoch: 1 | loss: 11034776.0000000
INFO:root:	iters: 12, epoch: 1 | loss: 10437427.0000000
INFO:root:	iters: 15, epoch: 1 | loss: 9730591.0000000
INFO:root:Epoch: 1 cost time: 25.96173620223999
INFO:root:loss_pred:10978215.266666668
INFO:root:loss entropy:9.814949289957683
INFO:root:loss smooth:0.1398981660604477
INFO:root:Epoch: 1 | Train Loss: 10978225.0666667 Vali Loss: nan Test Loss: 9462963.0000000
INFO:root:	iters: 3, epoch: 2 | loss: 9119600.0000000
INFO:root:	iters: 6, epoch: 2 | loss: 9194959.0000000
INFO:root:	iters: 9, epoch: 2 | loss: 8161579.0000000
INFO:root:	iters: 12, epoch: 2 | loss: 7233223.0000000
INFO:root:	iters: 15, epoch: 2 | loss: 6002328.5000000
INFO:root:Epoch: 2 cost time: 46.80141520500183
INFO:root:loss_pred:7991843.266666667
INFO:root:loss entropy:18.888135528564455
INFO:root:loss smooth:0.13409549395243328
INFO:root:Epoch: 2 | Train Loss: 7991862.1666667 Vali Loss: nan Test Loss: 5498992.0000000
INFO:root:	iters: 3, epoch: 3 | loss: 5338980.5000000
INFO:root:	iters: 6, epoch: 3 | loss: 4593799.5000000
INFO:root:	iters: 9, epoch: 3 | loss: 4143522.5000000
INFO:root:	iters: 12, epoch: 3 | loss: 3759413.2500000
INFO:root:	iters: 15, epoch: 3 | loss: 3802380.0000000
INFO:root:Epoch: 3 cost time: 62.69707489013672
INFO:root:loss_pred:4456646.766666667
INFO:root:loss entropy:17.553321838378906
INFO:root:loss smooth:0.1325889855623245
INFO:root:Epoch: 3 | Train Loss: 4456664.4000000 Vali Loss: nan Test Loss: 2541329.7500000
INFO:root:	iters: 3, epoch: 4 | loss: 2959283.2500000
INFO:root:	iters: 6, epoch: 4 | loss: 3051034.5000000
INFO:root:	iters: 9, epoch: 4 | loss: 2493895.5000000
INFO:root:	iters: 12, epoch: 4 | loss: 2643753.5000000
INFO:root:	iters: 15, epoch: 4 | loss: 2355813.2500000
INFO:root:Epoch: 4 cost time: 49.12999391555786
INFO:root:loss_pred:2726007.3333333335
INFO:root:loss entropy:15.99678300221761
INFO:root:loss smooth:0.13296547333399455
INFO:root:Epoch: 4 | Train Loss: 2726023.6000000 Vali Loss: nan Test Loss: 1630128.6250000
INFO:root:loading model
INFO:root:total_time:1.7767250537872314
INFO:root:avg_time:0.018316753131827127
INFO:root:mse:9462967.0, mae:563.4580688476562
